<?plantuml 1.2026.2beta3?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="569px" preserveAspectRatio="none" style="width:960px;height:569px;background:#FFFFFF;" version="1.1" viewBox="0 0 960 569" width="960px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="557.5859" style="stroke:#181818;stroke-width:0.5;" width="69.9814" x="496.8555" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25.416" x="519.1382" y="18.0669">QIP</text><g><title>Domain A</title><rect fill="#FFFFFF" height="453.8594" style="stroke:#181818;stroke-width:1;" width="10" x="56.1763" y="66.4297"/></g><g><title>Identity Provider</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="291.5112" y="87.5625"/></g><g><title>Identity Provider</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="291.5112" y="265.3594"/></g><g><title>Engine</title><rect fill="#FFFFFF" height="358.4609" style="stroke:#181818;stroke-width:1;" width="10" x="526.8462" y="145.8281"/></g><g><title>Domain B</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="897.3228" y="372.7578"/></g><rect fill="none" height="309.3281" style="stroke:#000000;stroke-width:1.5;" width="943.5127" x="10" y="202.9609"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:1.5;" width="351.4756" x="221.3613" y="227.0938"/><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="domain_a" id="part1-lifeline"><g><title>Domain A</title><rect fill="#000000" fill-opacity="0.00000" height="472.8594" width="8" x="57.1763" y="56.4297"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="61" x2="61" y1="56.4297" y2="529.2891"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="IDP" id="part2-lifeline"><g><title>Identity Provider</title><rect fill="#000000" fill-opacity="0.00000" height="472.8594" width="8" x="292.5112" y="56.4297"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="296.3613" x2="296.3613" y1="56.4297" y2="529.2891"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="QIP" id="part3-lifeline"><g><title>Engine</title><rect fill="#000000" fill-opacity="0.00000" height="472.8594" width="8" x="527.8462" y="56.4297"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="530.8555" x2="530.8555" y1="56.4297" y2="529.2891"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="domain_b" id="part4-lifeline"><g><title>Domain B</title><rect fill="#000000" fill-opacity="0.00000" height="472.8594" width="8" x="898.3228" y="56.4297"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="902.1328" x2="902.1328" y1="56.4297" y2="529.2891"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="domain_a" id="part1-head"><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.3525" x="20" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.3525" x="27" y="45.1279">Domain A</text></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="domain_a" id="part1-tail"><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.3525" x="20" y="528.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.3525" x="27" y="548.2842">Domain A</text></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="IDP" id="part2-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130.2998" x="231.3613" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.2998" x="238.3613" y="45.1279">Identity Provider</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="IDP" id="part2-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130.2998" x="231.3613" y="528.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.2998" x="238.3613" y="548.2842">Identity Provider</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="QIP" id="part3-head"><rect fill="#ADD8E6" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61.9814" x="500.8555" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.9814" x="507.8555" y="45.1279">Engine</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="QIP" id="part3-tail"><rect fill="#ADD8E6" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61.9814" x="500.8555" y="528.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.9814" x="507.8555" y="548.2842">Engine</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="domain_b" id="part4-head"><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.3799" x="861.1328" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.3799" x="868.1328" y="45.1279">Domain B</text></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="domain_b" id="part4-tail"><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.3799" x="861.1328" y="528.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.3799" x="868.1328" y="548.2842">Domain B</text></g><g><title>Domain A</title><rect fill="#FFFFFF" height="453.8594" style="stroke:#181818;stroke-width:1;" width="10" x="56.1763" y="66.4297"/></g><g><title>Identity Provider</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="291.5112" y="87.5625"/></g><g><title>Identity Provider</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="291.5112" y="265.3594"/></g><g><title>Engine</title><rect fill="#FFFFFF" height="358.4609" style="stroke:#181818;stroke-width:1;" width="10" x="526.8462" y="145.8281"/></g><g><title>Domain B</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="897.3228" y="372.7578"/></g><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg1"><polygon fill="#181818" points="279.5112,83.5625,289.5112,87.5625,279.5112,91.5625,283.5112,87.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="66.1763" x2="285.5112" y1="87.5625" y2="87.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.1343" x="73.1763" y="82.4966">[01] Log in with credentials</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg2"><polygon fill="#181818" points="77.1763,112.6953,67.1763,116.6953,77.1763,120.6953,73.1763,116.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="71.1763" x2="295.5112" y1="116.6953" y2="116.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.335" x="83.1763" y="111.6294">[02] Response with M2M token</text></g><g class="message" data-entity-1="part1" data-entity-2="part3" id="msg3"><polygon fill="#181818" points="514.8462,141.8281,524.8462,145.8281,514.8462,149.8281,518.8462,145.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="66.1763" x2="520.8462" y1="145.8281" y2="145.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.7056" x="73.1763" y="140.7622">[03] Request with M2M token</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg4"><line style="stroke:#181818;stroke-width:1;" x1="536.8462" x2="578.8462" y1="174.9609" y2="174.9609"/><line style="stroke:#181818;stroke-width:1;" x1="578.8462" x2="578.8462" y1="174.9609" y2="187.9609"/><line style="stroke:#181818;stroke-width:1;" x1="537.8462" x2="578.8462" y1="187.9609" y2="187.9609"/><polygon fill="#181818" points="547.8462,183.9609,537.8462,187.9609,547.8462,191.9609,543.8462,187.9609" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.6138" x="543.8462" y="169.895">[04] Token validation</text></g><path d="M10,202.9609 L74.4429,202.9609 L74.4429,210.0938 L64.4429,220.0938 L10,220.0938 L10,202.9609" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="309.3281" style="stroke:#000000;stroke-width:1.5;" width="943.5127" x="10" y="202.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="216.0278">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="127.5742" x="89.4429" y="215.1714">[M2M-token is valid]</text><path d="M221.3613,227.0938 L290.8125,227.0938 L290.8125,234.2266 L280.8125,244.2266 L221.3613,244.2266 L221.3613,227.0938" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:1.5;" width="351.4756" x="221.3613" y="227.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.4512" x="236.3613" y="240.1606">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="113.3086" x="305.8125" y="239.3042">[M2M need token]</text><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg5"><polygon fill="#181818" points="312.5112,261.3594,302.5112,265.3594,312.5112,269.3594,308.5112,265.3594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="306.5112" x2="525.8462" y1="265.3594" y2="265.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.7715" x="318.5112" y="260.2935">[05] Get M2M token</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg6"><polygon fill="#181818" points="514.8462,290.4922,524.8462,294.4922,514.8462,298.4922,518.8462,294.4922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="296.5112" x2="520.8462" y1="294.4922" y2="294.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.335" x="303.5112" y="289.4263">[06] Response with M2M token</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg7"><line style="stroke:#181818;stroke-width:1;" x1="536.8462" x2="578.8462" y1="330.625" y2="330.625"/><line style="stroke:#181818;stroke-width:1;" x1="578.8462" x2="578.8462" y1="330.625" y2="343.625"/><line style="stroke:#181818;stroke-width:1;" x1="537.8462" x2="578.8462" y1="343.625" y2="343.625"/><polygon fill="#181818" points="547.8462,339.625,537.8462,343.625,547.8462,347.625,543.8462,343.625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="330.4717" x="543.8462" y="325.5591">[07] Preserve current Authorization header's value</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg8"><polygon fill="#181818" points="885.3228,368.7578,895.3228,372.7578,885.3228,376.7578,889.3228,372.7578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="536.8462" x2="891.3228" y1="372.7578" y2="372.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.7056" x="543.8462" y="367.6919">[08] Request with M2M token</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg9"><polygon fill="#181818" points="547.8462,397.8906,537.8462,401.8906,547.8462,405.8906,543.8462,401.8906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="541.8462" x2="901.3228" y1="401.8906" y2="401.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.8374" x="553.8462" y="396.8247">[09] Response</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg10"><line style="stroke:#181818;stroke-width:1;" x1="536.8462" x2="578.8462" y1="431.0234" y2="431.0234"/><line style="stroke:#181818;stroke-width:1;" x1="578.8462" x2="578.8462" y1="431.0234" y2="444.0234"/><line style="stroke:#181818;stroke-width:1;" x1="537.8462" x2="578.8462" y1="444.0234" y2="444.0234"/><polygon fill="#181818" points="547.8462,440.0234,537.8462,444.0234,547.8462,448.0234,543.8462,444.0234" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="336.4766" x="543.8462" y="425.9575">[10] Reinstate original Authorization header's value</text></g><g class="message" data-entity-1="part3" data-entity-2="part1" id="msg11"><polygon fill="#181818" points="77.1763,469.1563,67.1763,473.1563,77.1763,477.1563,73.1763,473.1563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="71.1763" x2="525.8462" y1="473.1563" y2="473.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.8374" x="83.1763" y="468.0903">[11] Response</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="953.5127" y1="482.1563" y2="482.1563"/><g class="message" data-entity-1="part3" data-entity-2="part1" id="msg12"><polygon fill="#181818" points="77.1763,500.2891,67.1763,504.2891,77.1763,508.2891,73.1763,504.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="71.1763" x2="530.8462" y1="504.2891" y2="504.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.606" x="83.1763" y="499.2231">[12] Response with access error</text></g><?plantuml-src ZP9TIyCm58Rl-ojUjWilIc6RtoB2ncGCDfWYU255ilQm1cjIatHEVxr9sdNTT62lskOvRvwJau8fmnDUC67G6SjtnWM67J2Dr7-yCdHdV9MPYI8IGT76foa9myqN5agkUKhArqt7Ys0aD-WyJ1STT9ypRcY_xbwik20FMwRE7-Kb1IHIBELc7w-jHcshvPxLLZKCcrT4Tyua36_mqkl7cCaLRCWdDnaIHTwSvNh7tqQHvQF8yOCOZwGBAJHL5VF174Q-jRPo-LQ-oZzr_4T9sXpYhh-ATDnPZ2Vt6skMyvGPBaN0SkFuoFFWkbeB05du1GYYj4w3VUh4fhVp61CohIsta6q8JKSNnpi2xAa7JN2jUXdRgP8cjIOafLBsl30iJIOL__RYo8ZPaPzuOJkw9c0xeKhlwkZHx2ot5PNgzKxrqAhVSsjSQCCCmQhOUyJoVtdjn1XSKh-r2-NwByxhz7_T1POaf3L8AQdSXVq1?></g></svg>